if "cisco-fw" in [tags] {
    grok {
    patterns_dir => [ "/etc/logstash/patterns" ]
    match => [
    "message", "%{CISCOFW113019}",
    "message", "%{CISCOFW713041}",
    "message", "%{CISCOFW713049}",
    "message", "%{CISCOFW713050}",
    "message", "%{CISCOFW713075}",
    "message", "%{CISCOFW713076}",
    "message", "%{CISCOFW713119}",
    "message", "%{CISCOFW713120}",
    "message", "%{CISCOFW713184}",
    "message", "%{CISCOFW713259}"
    ]
    add_tag => [ "Cisco VPN" ]
    }
}
if "cisco-fw" in [tags] and "Cisco VPN" not in [tags] {
    grok {
    patterns_dir => [ "/etc/logstash/patterns" ]
    match => [
    "message", "%{CISCOFW104001}",
    "message", "%{CISCOFW104002}",
    "message", "%{CISCOFW104003}",
    "message", "%{CISCOFW104004}",
    "message", "%{CISCOFW105003}",
    "message", "%{CISCOFW105004}",
    "message", "%{CISCOFW105005}",
    "message", "%{CISCOFW105008}",
    "message", "%{CISCOFW105009}",
    "message", "%{CISCOFW106001_1}",
    "message", "%{CISCOFW106001_2}",
    "message", "%{CISCOFW106006_106007_1}",
    "message", "%{CISCOFW106006_106007_2}",
    "message", "%{CISCOFW106010}",
    "message", "%{CISCOFW106014}",
    "message", "%{CISCOFW106015}",
    "message", "%{CISCOFW106016}",
    "message", "%{CISCOFW106017}",
    "message", "%{CISCOFW106020}",
    "message", "%{CISCOFW106021}",
    "message", "%{CISCOFW106023}",
    "message", "%{CISCOFW106100}",
    "message", "%{CISCOFW106101}",
    "message", "%{CISCOFW110002}",
    "message", "%{CISCOFW110003}",
    "message", "%{CISCOFW111007}",
    "message", "%{CISCOFW111010}",
    "message", "%{CISCOFW111008}",
    "message", "%{CISCOFW113004}",
    "message", "%{CISCOFW113005}",
    "message", "%{CISCOFW113008}",
    "message", "%{CISCOFW113009}",
    "message", "%{CISCOFW302010}",
    "message", "%{CISCOFW302013_302014_302015_302016_1}",
    "message", "%{CISCOFW302013_302014_302015_302016_2}",
    "message", "%{CISCOFW302020_302021_1}",
    "message", "%{CISCOFW302020_302021_2}",
    "message", "%{CISCOFW303002}",
    "message", "%{CISCOFW304001}",
    "message", "%{CISCOFW305006}",
    "message", "%{CISCOFW305011}",
    "message", "%{CISCOFW313001_313004_313008}",
    "message", "%{CISCOFW313005}",
    "message", "%{CISCOFW313009}",
    "message", "%{CISCOFW315011}",
    "message", "%{CISCOFW321001}",
    "message", "%{CISCOFW402117}",
    "message", "%{CISCOFW402119}",
    "message", "%{CISCOFW410001}",
    "message", "%{CISCOFW419001}",
    "message", "%{CISCOFW419002}",
    "message", "%{CISCOFW500004}",
    "message", "%{CISCOFW502103}",
    "message", "%{CISCOFW602101}",
    "message", "%{CISCOFW602303_602304_1}",
    "message", "%{CISCOFW602303_602304_2}",
    "message", "%{CISCOFW605005}",
    "message", "%{CISCOFW607001}",
    "message", "%{CISCOFW611101}",
    "message", "%{CISCOFW611103}",
    "message", "%{CISCOFW622001}",
    "message", "%{CISCOFW710001_710002_710003_710005_710006}",
    "message", "%{CISCOFW713073}",
    "message", "%{CISCOFW713074}",
    "message", "%{CISCOFW713130}",
    "message", "%{CISCOFW713172}",
    "message", "%{CISCOFW713228}",
    "message", "%{CISCOFW713902}",
    "message", "%{CISCOFW713904}",
    "message", "%{CISCOFW713905_1}",
    "message", "%{CISCOFW713905}",
    "message", "%{CISCOFW725001}",
    "message", "%{CISCOFW725002}",
    "message", "%{CISCOFW725003}",
    "message", "%{CISCOFW725006}",
    "message", "%{CISCOFW725007}",
    "message", "%{CISCOFW733100}",
    "message", "%{CISCOFW734001}",
    "message", "%{CISCOFW737006}",
    "message", "%{CISCOFW737016}",
    "message", "%{CISCOFW737026}",
    "message", "%{CISCOFW746005}",
    "message", "%{CISCOFW746006}",
    "message", "%{CISCOFW752004}",
    "message", "%{CISCOFW752010}",
    "message", "%{CISCOFW752016}"
    ]
    }
}
if "cisco-fw" in [tags] {
    mutate {
    remove_tag => [ "_grokparsefailure" ]
    gsub => [
    "facility", "109", "Auth",
    "facility", "113", "Auth",
    "facility", "110", "Bridge",
    "facility", "220", "Bridge",
    "facility", "717", "ca",
    "facility", "111", "Config",
    "facility", "112", "Config",
    "facility", "208", "Config",
    "facility", "308", "Config",
    "facility", "734", "dap",
    "facility", "719", "e-mail",
    "facility", "101", "ha",
    "facility", "102", "ha",
    "facility", "103", "ha",
    "facility", "104", "ha",
    "facility", "105", "ha",
    "facility", "210", "ha",
    "facility", "311", "ha",
    "facility", "709", "ha",
    "facility", "209", "ip",
    "facility", "215", "ip",
    "facility", "313", "ip",
    "facility", "317", "ip",
    "facility", "408", "ip",
    "facility", "422", "ip",
    "facility", "735", "ipaa",
    "facility", "737", "ipaa",
    "facility", "400", "ips",
    "facility", "401", "ips",
    "facility", "410", "ips",
    "facility", "415", "ips",
    "facility", "416", "ips",
    "facility", "419", "ips",
    "facility", "420", "ips",
    "facility", "423", "ips",
    "facility", "424", "ips",
    "facility", "319", "np",
    "facility", "725", "npssl",
    "facility", "318", "ospf",
    "facility", "409", "ospf",
    "facility", "503", "ospf",
    "facility", "613", "ospf",
    "facility", "107", "rip",
    "facility", "312", "rip",
    "facility", "321", "rm",
    "facility", "106", "Session",
    "facility", "108", "Session",
    "facility", "201", "Session",
    "facility", "202", "Session",
    "facility", "204", "Session",
    "facility", "302", "Session",
    "facility", "303", "Session",
    "facility", "304", "Session",
    "facility", "305", "Session",
    "facility", "314", "Session",
    "facility", "405", "Session",
    "facility", "406", "Session",
    "facility", "407", "Session",
    "facility", "500", "Session",
    "facility", "502", "Session",
    "facility", "607", "Session",
    "facility", "608", "Session",
    "facility", "609", "Session",
    "facility", "616", "Session",
    "facility", "620", "Session",
    "facility", "703", "Session",
    "facility", "710", "Session",
    "facility", "212", "snmp",
    "facility", "199", "sys",
    "facility", "211", "sys",
    "facility", "214", "sys",
    "facility", "216", "sys",
    "facility", "306", "sys",
    "facility", "307", "sys",
    "facility", "315", "sys",
    "facility", "414", "sys",
    "facility", "604", "sys",
    "facility", "605", "sys",
    "facility", "606", "sys",
    "facility", "610", "sys",
    "facility", "612", "sys",
    "facility", "614", "sys",
    "facility", "615", "sys",
    "facility", "701", "sys",
    "facility", "711", "sys",
    "facility", "213", "vpdn",
    "facility", "403", "vpdn",
    "facility", "603", "vpdn",
    "facility", "316", "vpn",
    "facility", "320", "vpn",
    "facility", "402", "vpn",
    "facility", "404", "vpn",
    "facility", "501", "vpn",
    "facility", "602", "vpn",
    "facility", "702", "vpn",
    "facility", "713", "vpn",
    "facility", "714", "vpn",
    "facility", "715", "vpn",
    "facility", "720", "vpn",
    "facility", "750", "vpn",
    "facility", "752", "vpn",
    "facility", "753", "vpn",
    "facility", "611", "vpnc",
    "facility", "720", "vpnfo",
    "facility", "718", "vpnlb",
    "facility", "716", "Webvpn",
    "facility", "722", "Webvpn",
    "facility", "724", "Webvpn",
    "facility", "751", "Webvpn",
    "facility", "721", "acl",
    "facility", "747", "Clustering",
    "facility", "733", "Threat-detection"
    ]
    }
}
