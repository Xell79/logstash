grok {
patterns_dir => [ "/etc/logstash/patterns" ]
match => [
"message", "%{SYSLOG5424PRI}%{NUMBER} %{TIMESTAMP_ISO8601:log_date} %{GREEDYDATA:facility} - - %{GREEDYDATA}=\"%{INT:sequenceId}\"] Type: %{GREEDYDATA:facility_mnemonic}, EventId: %{INT:EventId}, EventTime: %{DATESTAMP_IXIA:EventTime}, %{GREEDYDATA:message}, SystemName: %{GREEDYDATA:SystemName}, AnalyticsConfigTime: %{DATESTAMP_IXIA:AnalyticsConfigTime}, Overflow: %{INT:Overflow}",
"message", "%{SYSLOG5424PRI}%{NUMBER} %{TIMESTAMP_ISO8601:log_date} %{GREEDYDATA:facility} - - %{GREEDYDATA}=\"%{INT:sequenceId}\"] Type: %{GREEDYDATA:facility_mnemonic}, EventId: %{INT:EventId}, EventTime: %{DATESTAMP_IXIA:EventTime}, %{GREEDYDATA:message}, SystemName: %{GREEDYDATA:SystemName}",
"message", "%{SYSLOG5424PRI}%{NUMBER} %{TIMESTAMP_ISO8601:log_date} %{GREEDYDATA:facility} - - %{GREEDYDATA}=\"%{INT:sequenceId}\"] Type: %{GREEDYDATA:facility_mnemonic}, EventId: %{INT:EventId}, EventTime: %{DATESTAMP_IXIA:EventTime}, SystemName: %{GREEDYDATA:SystemName}, ReportInterval: %{INT:ReportIntervalSec} seconds, Uptime: %{INT:Uptime}",
"message", "%{SYSLOG5424PRI}%{NUMBER} %{TIMESTAMP_ISO8601:log_date} %{GREEDYDATA:facility} - - %{GREEDYDATA}=\"%{INT:sequenceId}\"] %{GREEDYDATA:message}"
]
remove_field => [ "syslog5424_pri", "@version" ]
add_tag => [ "ixia" ]
remove_tag => [ "_grokparsefailure" ]
overwrite => [ "message" ]
}

if "ixia" in [tags] {                                                                                                                                                                                                                                                                                                                                                                                           
    grok {                                                                                                                                                                                                                                                                                                                                                                                                      
    patterns_dir => [ "/etc/logstash/patterns" ]                                                                                                                                                                                                                                                                                                                                                                
    match => [                                                                                                                                                                                                                                                                                                                                                                                                  
    "message", "GroupId: %{INT:GroupId}, GroupName: %{GREEDYDATA:GroupName}, NetworkPort: %{INT:NetworkPort}, AE: %{INT:AE}, SampleInterval: %{INT:SampleInterval_ms}ms, UtilizationThreshold: %{INT:UtilizationThreshold%}%, Rate: %{INT:RateMbps}Mb/s, BurstByteCount: %{INT:BurstByteCount}B, ReportedUtilization: %{INT:ReportedUtilization}%, ReportedEffectiveRate: %{INT:ReportedEffectiveRateMbps}Mb/s",
    "message", "PortName: %{GREEDYDATA:PortName}, NetworkPort: %{INT:NetworkPort}, AE: %{INT:AE}, SampleInterval: %{INT:SampleInterval_ms}ms, Utilization: %{INT:Utilization%}%, PortSpeed: %{INT:PortSpeedMbps}Mb/s, BurstByteCount: %{INT:BurstByteCount}B, ReportedUtilization: %{INT:ReportedUtilization}%, ReportedEffectiveDataRate: %{INT:ReportedEffectiveDataRateMbps}Mb/s",                           
    "message", "ChannelId: %{INT:ChannelId}, Channel: %{GREEDYDATA:Channel}, NetworkPort: %{INT:NetworkPort}, AE: %{INT:AE}, PreGapSeqNum: %{INT:PreGapSeqNum}, PostGapSeqNum: %{INT:PostGapSeqNum}",                                                                                                                                                                                                           
    "message", "ChannelId: %{INT:ChannelId}, Channel: %{GREEDYDATA:Channel}, NetworkPort: %{INT:NetworkPort}, AE: %{INT:AE}, PreGapSeqNum: %{INT:PreGapSeqNum}, PostGapSeqNum: %{INT:PostGapSeqNum}, Multiplexed Feed Type: %{GREEDYDATA:MultiplexedFeedType}, Stream Id: %{INT:StreamId}, Source Id: %{GREEDYDATA:SourceId}",                                                                                  
    "message", "ChannelId: %{INT:ChannelId}, Channel: %{GREEDYDATA:Channel}, NetworkPort: %{INT:NetworkPort}, AE: %{INT:AE}, ReportInterval: %{INT:ReportIntervalSec} seconds, ReportMode: %{GREEDYDATA:ReportMode}, State: %{GREEDYDATA:State}",                                                                                                                                                               
    "message", "GroupId: %{INT:GroupId}, GroupName: %{GREEDYDATA:GroupName}, NetworkPort: %{INT:NetworkPort}, AE: %{INT:AE}, ReportInterval: %{INT:ReportIntervalSec} seconds, Utilization: %{INT:Utilization%}%, Rate: %{INT:RateKbps} Kb/s, ReportMode: %{GREEDYDATA:ReportMode}, State: %{GREEDYDATA:State}",                                                                                                
    "message", "GroupId: %{INT:GroupId}, GroupName: %{GREEDYDATA:GroupName}, NetworkPort: %{INT:NetworkPort}, AE: %{INT:AE}, ReportInterval: %{INT:ReportIntervalSec} seconds, Utilization: %{INT:Utilization%}%, Rate: %{INT:RateMbps} Mb/s, ReportMode: %{GREEDYDATA:ReportMode}, State: %{GREEDYDATA:State}",                                                                                                
    "message", "PortName: %{GREEDYDATA:PortName}, NetworkPort: %{INT:NetworkPort}, AE: %{INT:AE}, ReportInterval: %{INT:ReportIntervalSec} seconds, Utilization: %{INT:Utilization%}%, PortSpeed: %{INT:PortSpeedMbps} Mb/s, ReportMode: %{GREEDYDATA:ReportMode}, State: %{GREEDYDATA:State}",                                                                                                                 
    "message", "AEName: %{GREEDYDATA:AEName}, NetworkPort: %{INT:NetworkPort}, AE: %{INT:AE}, ReportInterval: %{INT:ReportIntervalSec} seconds, Utilization: %{INT:Utilization%}%, PortSpeed: %{INT:PortSpeedMbps} Mb/s, ReportMode: %{GREEDYDATA:ReportMode}, State: %{GREEDYDATA:State}",                                                                                                                     
    "message", "PortName: %{GREEDYDATA:PortName}, NetworkPort: %{INT:NetworkPort}, AE: %{INT:AE}, LimitType: %{GREEDYDATA:LimitType}, Status: %{GREEDYDATA:Status}, Threshold: %{INT:ThresholdEventPerSec} events/sec, ThresholdDuration: %{INT:ThresholdDurationSec} seconds, Auto-ResetTime: %{GREEDYDATA:AutoResetTime}",                                                                                    
    "message", "%{GREEDYDATA:User} - %{GREEDYDATA:activities}"                                                                                                                                                                                                                                                                                                                                                  
    ]                                                                                                                                                                                                                                                                                                                                                                                                           
    }                                                                                                                                                                                                                                                                                                                                                                                                           
}                                                                                                                                                                                                                                                                                                                                                                                                               
